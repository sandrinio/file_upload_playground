{"version":3,"sources":["../../../../../public/ckeditor/plugins/floatpanel/plugin.js"],"names":["CKEDITOR","plugins","add","requires","panels","getPanel","editor","doc","parentElement","definition","level","key","tools","genKey","getUniqueId","lang","dir","uiColor","css","panel","ui","element","append","dom","createFromHtml","render","setStyles","display","position","floatPanel","createClass","$","forceIFrame","toolbarRelated","elementMode","ELEMENT_MODE_INLINE","document","getById","name","getDocument","iframe","getFirst","that","disableContextMenu","_","children","showBlockParams","on","hide","getWindow","reposition","proto","addBlock","block","addListBlock","multiSelect","getBlock","showBlock","offsetParent","corner","offsetX","offsetY","callback","slice","call","arguments","allowBlur","editable","returnFocus","hasFocus","activeElement","hideTimeout","focused","env","ie","edge","window","contentWindow","positionedAncestor","getPositionedAncestor","getDocumentPosition","positionedAncestorPosition","x","y","rtl","left","top","offsetWidth","offsetHeight","offsetParentId","getId","setOpacity","removeStyle","focusManager","blurSet","event","useCapture","ev","data","getPhase","EVENT_PHASE_AT_TARGET","visible","activeChild","iOS","setTimeout","doHide","hideChild","clearTimeout","focus","onEscape","bind","keystroke","panelLoad","target","autoSize","panelDoc","width","webkit","getBody","scrollWidth","quirks","clientWidth","setStyle","height","scrollHeight","clientHeight","currentBlock","panelElement","panelWindow","rect","getBoundingClientRect","viewportSize","getViewPaneSize","rectWidth","right","rectHeight","bottom","spaceAfter","spaceBefore","spaceBelow","spaceAbove","scrollParent","getName","getComputedStyle","ie8Compat","getDocumentElement","scrollLeft","innerElement","activePanel","getCustomData","onHide","setCustomData","isLoaded","onLoad","scrollTop","getScrollPosition","markFirstDisplayed","fire","air","onShow","blockParams","apply","active","getActive","equals","blur","lastFocused","getFrameDocument","is","gecko","removeCustomData","focusReturn","type","allow","undefined","showAsChild","blockName","ie7Compat","ie6Compat","getChild","style","cssText","restoreFocus","isLastInstance","isEmpty","instances","i","destroy"],"mappings":"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","file":"plugin.js","sourcesContent":["/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md or http://ckeditor.com/license\n */\n\nCKEDITOR.plugins.add( 'floatpanel', {\n\trequires: 'panel'\n} );\n\n( function() {\n\tvar panels = {};\n\n\tfunction getPanel( editor, doc, parentElement, definition, level ) {\n\t\t// Generates the panel key: docId-eleId-skinName-langDir[-uiColor][-CSSs][-level]\n\t\tvar key = CKEDITOR.tools.genKey( doc.getUniqueId(), parentElement.getUniqueId(), editor.lang.dir, editor.uiColor || '', definition.css || '', level || '' ),\n\t\t\tpanel = panels[ key ];\n\n\t\tif ( !panel ) {\n\t\t\tpanel = panels[ key ] = new CKEDITOR.ui.panel( doc, definition );\n\t\t\tpanel.element = parentElement.append( CKEDITOR.dom.element.createFromHtml( panel.render( editor ), doc ) );\n\n\t\t\tpanel.element.setStyles( {\n\t\t\t\tdisplay: 'none',\n\t\t\t\tposition: 'absolute'\n\t\t\t} );\n\t\t}\n\n\t\treturn panel;\n\t}\n\n\t/**\n\t * Represents a floating panel UI element.\n\t *\n\t * It is reused by rich combos, color combos, menus, etc.\n\t * and it renders its content using {@link CKEDITOR.ui.panel}.\n\t *\n\t * @class\n\t * @todo\n\t */\n\tCKEDITOR.ui.floatPanel = CKEDITOR.tools.createClass( {\n\t\t/**\n\t\t * Creates a floatPanel class instance.\n\t\t *\n\t\t * @constructor\n\t\t * @param {CKEDITOR.editor} editor\n\t\t * @param {CKEDITOR.dom.element} parentElement\n\t\t * @param {Object} definition Definition of the panel that will be floating.\n\t\t * @param {Number} level\n\t\t */\n\t\t$: function( editor, parentElement, definition, level ) {\n\t\t\tdefinition.forceIFrame = 1;\n\n\t\t\t// In case of editor with floating toolbar append panels that should float\n\t\t\t// to the main UI element.\n\t\t\tif ( definition.toolbarRelated && editor.elementMode == CKEDITOR.ELEMENT_MODE_INLINE )\n\t\t\t\tparentElement = CKEDITOR.document.getById( 'cke_' + editor.name );\n\n\t\t\tvar doc = parentElement.getDocument(),\n\t\t\t\tpanel = getPanel( editor, doc, parentElement, definition, level || 0 ),\n\t\t\t\telement = panel.element,\n\t\t\t\tiframe = element.getFirst(),\n\t\t\t\tthat = this;\n\n\t\t\t// Disable native browser menu. (http://dev.ckeditor.com/ticket/4825)\n\t\t\telement.disableContextMenu();\n\n\t\t\tthis.element = element;\n\n\t\t\tthis._ = {\n\t\t\t\teditor: editor,\n\t\t\t\t// The panel that will be floating.\n\t\t\t\tpanel: panel,\n\t\t\t\tparentElement: parentElement,\n\t\t\t\tdefinition: definition,\n\t\t\t\tdocument: doc,\n\t\t\t\tiframe: iframe,\n\t\t\t\tchildren: [],\n\t\t\t\tdir: editor.lang.dir,\n\t\t\t\tshowBlockParams: null\n\t\t\t};\n\n\t\t\teditor.on( 'mode', hide );\n\t\t\teditor.on( 'resize', hide );\n\n\t\t\t// When resize of the window is triggered floatpanel should be repositioned according to new dimensions.\n\t\t\t// http://dev.ckeditor.com/ticket/11724. Fixes issue with undesired panel hiding on Android and iOS.\n\t\t\tdoc.getWindow().on( 'resize', function() {\n\t\t\t\tthis.reposition();\n\t\t\t}, this );\n\n\t\t\t// We need a wrapper because events implementation doesn't allow to attach\n\t\t\t// one listener more than once for the same event on the same object.\n\t\t\t// Remember that floatPanel#hide is shared between all instances.\n\t\t\tfunction hide() {\n\t\t\t\tthat.hide();\n\t\t\t}\n\t\t},\n\n\t\tproto: {\n\t\t\t/**\n\t\t\t * @todo\n\t\t\t */\n\t\t\taddBlock: function( name, block ) {\n\t\t\t\treturn this._.panel.addBlock( name, block );\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * @todo\n\t\t\t */\n\t\t\taddListBlock: function( name, multiSelect ) {\n\t\t\t\treturn this._.panel.addListBlock( name, multiSelect );\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * @todo\n\t\t\t */\n\t\t\tgetBlock: function( name ) {\n\t\t\t\treturn this._.panel.getBlock( name );\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * Shows the panel block.\n\t\t\t *\n\t\t\t * @param {String} name\n\t\t\t * @param {CKEDITOR.dom.element} offsetParent Positioned parent.\n\t\t\t * @param {Number} corner\n\t\t\t *\n\t\t\t * * For LTR (left to right) oriented editor:\n\t\t\t *      * `1` = top-left\n\t\t\t *      * `2` = top-right\n\t\t\t *      * `3` = bottom-right\n\t\t\t *      * `4` = bottom-left\n\t\t\t * * For RTL (right to left):\n\t\t\t *      * `1` = top-right\n\t\t\t *      * `2` = top-left\n\t\t\t *      * `3` = bottom-left\n\t\t\t *      * `4` = bottom-right\n\t\t\t *\n\t\t\t * @param {Number} [offsetX=0]\n\t\t\t * @param {Number} [offsetY=0]\n\t\t\t * @param {Function} [callback] A callback function executed when block positioning is done.\n\t\t\t * @todo what do exactly these params mean (especially corner)?\n\t\t\t */\n\t\t\tshowBlock: function( name, offsetParent, corner, offsetX, offsetY, callback ) {\n\t\t\t\tvar panel = this._.panel,\n\t\t\t\t\tblock = panel.showBlock( name );\n\n\t\t\t\tthis._.showBlockParams = [].slice.call( arguments );\n\t\t\t\tthis.allowBlur( false );\n\n\t\t\t\t// Record from where the focus is when open panel.\n\t\t\t\tvar editable = this._.editor.editable();\n\t\t\t\tthis._.returnFocus = editable.hasFocus ? editable : new CKEDITOR.dom.element( CKEDITOR.document.$.activeElement );\n\t\t\t\tthis._.hideTimeout = 0;\n\n\t\t\t\tvar element = this.element,\n\t\t\t\t\tiframe = this._.iframe,\n\t\t\t\t\t// Edge prefers iframe's window to the iframe, just like the rest of the browsers (http://dev.ckeditor.com/ticket/13143).\n\t\t\t\t\tfocused = CKEDITOR.env.ie && !CKEDITOR.env.edge ? iframe : new CKEDITOR.dom.window( iframe.$.contentWindow ),\n\t\t\t\t\tdoc = element.getDocument(),\n\t\t\t\t\tpositionedAncestor = this._.parentElement.getPositionedAncestor(),\n\t\t\t\t\tposition = offsetParent.getDocumentPosition( doc ),\n\t\t\t\t\tpositionedAncestorPosition = positionedAncestor ? positionedAncestor.getDocumentPosition( doc ) : { x: 0, y: 0 },\n\t\t\t\t\trtl = this._.dir == 'rtl',\n\t\t\t\t\tleft = position.x + ( offsetX || 0 ) - positionedAncestorPosition.x,\n\t\t\t\t\ttop = position.y + ( offsetY || 0 ) - positionedAncestorPosition.y;\n\n\t\t\t\t// Floating panels are off by (-1px, 0px) in RTL mode. (http://dev.ckeditor.com/ticket/3438)\n\t\t\t\tif ( rtl && ( corner == 1 || corner == 4 ) )\n\t\t\t\t\tleft += offsetParent.$.offsetWidth;\n\t\t\t\telse if ( !rtl && ( corner == 2 || corner == 3 ) )\n\t\t\t\t\tleft += offsetParent.$.offsetWidth - 1;\n\n\t\t\t\tif ( corner == 3 || corner == 4 )\n\t\t\t\t\ttop += offsetParent.$.offsetHeight - 1;\n\n\t\t\t\t// Memorize offsetParent by it's ID.\n\t\t\t\tthis._.panel._.offsetParentId = offsetParent.getId();\n\n\t\t\t\telement.setStyles( {\n\t\t\t\t\ttop: top + 'px',\n\t\t\t\t\tleft: 0,\n\t\t\t\t\tdisplay: ''\n\t\t\t\t} );\n\n\t\t\t\t// Don't use display or visibility style because we need to\n\t\t\t\t// calculate the rendering layout later and focus the element.\n\t\t\t\telement.setOpacity( 0 );\n\n\t\t\t\t// To allow the context menu to decrease back their width\n\t\t\t\telement.getFirst().removeStyle( 'width' );\n\n\t\t\t\t// Report to focus manager.\n\t\t\t\tthis._.editor.focusManager.add( focused );\n\n\t\t\t\t// Configure the IFrame blur event. Do that only once.\n\t\t\t\tif ( !this._.blurSet ) {\n\n\t\t\t\t\t// With addEventListener compatible browsers, we must\n\t\t\t\t\t// useCapture when registering the focus/blur events to\n\t\t\t\t\t// guarantee they will be firing in all situations. (http://dev.ckeditor.com/ticket/3068, http://dev.ckeditor.com/ticket/3222 )\n\t\t\t\t\tCKEDITOR.event.useCapture = true;\n\n\t\t\t\t\tfocused.on( 'blur', function( ev ) {\n\t\t\t\t\t\t// As we are using capture to register the listener,\n\t\t\t\t\t\t// the blur event may get fired even when focusing\n\t\t\t\t\t\t// inside the window itself, so we must ensure the\n\t\t\t\t\t\t// target is out of it.\n\t\t\t\t\t\tif ( !this.allowBlur() || ev.data.getPhase() != CKEDITOR.EVENT_PHASE_AT_TARGET )\n\t\t\t\t\t\t\treturn;\n\n\t\t\t\t\t\tif ( this.visible && !this._.activeChild ) {\n\t\t\t\t\t\t\t// [iOS] Allow hide to be prevented if touch is bound\n\t\t\t\t\t\t\t// to any parent of the iframe blur happens before touch (http://dev.ckeditor.com/ticket/10714).\n\t\t\t\t\t\t\tif ( CKEDITOR.env.iOS ) {\n\t\t\t\t\t\t\t\tif ( !this._.hideTimeout )\n\t\t\t\t\t\t\t\t\tthis._.hideTimeout = CKEDITOR.tools.setTimeout( doHide, 0, this );\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tdoHide.call( this );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tfunction doHide() {\n\t\t\t\t\t\t\t// Panel close is caused by user's navigating away the focus, e.g. click outside the panel.\n\t\t\t\t\t\t\t// DO NOT restore focus in this case.\n\t\t\t\t\t\t\tdelete this._.returnFocus;\n\t\t\t\t\t\t\tthis.hide();\n\t\t\t\t\t\t}\n\t\t\t\t\t}, this );\n\n\t\t\t\t\tfocused.on( 'focus', function() {\n\t\t\t\t\t\tthis._.focused = true;\n\t\t\t\t\t\tthis.hideChild();\n\t\t\t\t\t\tthis.allowBlur( true );\n\t\t\t\t\t}, this );\n\n\t\t\t\t\t// [iOS] if touch is bound to any parent of the iframe blur\n\t\t\t\t\t// happens twice before touchstart and before touchend (http://dev.ckeditor.com/ticket/10714).\n\t\t\t\t\tif ( CKEDITOR.env.iOS ) {\n\t\t\t\t\t\t// Prevent false hiding on blur.\n\t\t\t\t\t\t// We don't need to return focus here because touchend will fire anyway.\n\t\t\t\t\t\t// If user scrolls and pointer gets out of the panel area touchend will also fire.\n\t\t\t\t\t\tfocused.on( 'touchstart', function() {\n\t\t\t\t\t\t\tclearTimeout( this._.hideTimeout );\n\t\t\t\t\t\t}, this );\n\n\t\t\t\t\t\t// Set focus back to handle blur and hide panel when needed.\n\t\t\t\t\t\tfocused.on( 'touchend', function() {\n\t\t\t\t\t\t\tthis._.hideTimeout = 0;\n\t\t\t\t\t\t\tthis.focus();\n\t\t\t\t\t\t}, this );\n\t\t\t\t\t}\n\n\t\t\t\t\tCKEDITOR.event.useCapture = false;\n\n\t\t\t\t\tthis._.blurSet = 1;\n\t\t\t\t}\n\n\t\t\t\tpanel.onEscape = CKEDITOR.tools.bind( function( keystroke ) {\n\t\t\t\t\tif ( this.onEscape && this.onEscape( keystroke ) === false )\n\t\t\t\t\t\treturn false;\n\t\t\t\t}, this );\n\n\t\t\t\tCKEDITOR.tools.setTimeout( function() {\n\t\t\t\t\tvar panelLoad = CKEDITOR.tools.bind( function() {\n\t\t\t\t\t\tvar target = element;\n\n\t\t\t\t\t\t// Reset panel width as the new content can be narrower\n\t\t\t\t\t\t// than the old one. (http://dev.ckeditor.com/ticket/9355)\n\t\t\t\t\t\ttarget.removeStyle( 'width' );\n\n\t\t\t\t\t\tif ( block.autoSize ) {\n\t\t\t\t\t\t\tvar panelDoc = block.element.getDocument(),\n\t\t\t\t\t\t\t\twidth = ( ( CKEDITOR.env.webkit || CKEDITOR.env.edge ) ? block.element : panelDoc.getBody() ).$.scrollWidth;\n\n\t\t\t\t\t\t\t// Account for extra height needed due to IE quirks box model bug:\n\t\t\t\t\t\t\t// http://en.wikipedia.org/wiki/Internet_Explorer_box_model_bug\n\t\t\t\t\t\t\t// (http://dev.ckeditor.com/ticket/3426)\n\t\t\t\t\t\t\tif ( CKEDITOR.env.ie && CKEDITOR.env.quirks && width > 0 )\n\t\t\t\t\t\t\t\twidth += ( target.$.offsetWidth || 0 ) - ( target.$.clientWidth || 0 ) + 3;\n\n\t\t\t\t\t\t\t// Add some extra pixels to improve the appearance.\n\t\t\t\t\t\t\twidth += 10;\n\n\t\t\t\t\t\t\ttarget.setStyle( 'width', width + 'px' );\n\n\t\t\t\t\t\t\tvar height = block.element.$.scrollHeight;\n\n\t\t\t\t\t\t\t// Account for extra height needed due to IE quirks box model bug:\n\t\t\t\t\t\t\t// http://en.wikipedia.org/wiki/Internet_Explorer_box_model_bug\n\t\t\t\t\t\t\t// (http://dev.ckeditor.com/ticket/3426)\n\t\t\t\t\t\t\tif ( CKEDITOR.env.ie && CKEDITOR.env.quirks && height > 0 )\n\t\t\t\t\t\t\t\theight += ( target.$.offsetHeight || 0 ) - ( target.$.clientHeight || 0 ) + 3;\n\n\t\t\t\t\t\t\ttarget.setStyle( 'height', height + 'px' );\n\n\t\t\t\t\t\t\t// Fix IE < 8 visibility.\n\t\t\t\t\t\t\tpanel._.currentBlock.element.setStyle( 'display', 'none' ).removeStyle( 'display' );\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\ttarget.removeStyle( 'height' );\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Flip panel layout horizontally in RTL with known width.\n\t\t\t\t\t\tif ( rtl )\n\t\t\t\t\t\t\tleft -= element.$.offsetWidth;\n\n\t\t\t\t\t\t// Pop the style now for measurement.\n\t\t\t\t\t\telement.setStyle( 'left', left + 'px' );\n\n\t\t\t\t\t\t/* panel layout smartly fit the viewport size. */\n\t\t\t\t\t\tvar panelElement = panel.element,\n\t\t\t\t\t\t\tpanelWindow = panelElement.getWindow(),\n\t\t\t\t\t\t\trect = element.$.getBoundingClientRect(),\n\t\t\t\t\t\t\tviewportSize = panelWindow.getViewPaneSize();\n\n\t\t\t\t\t\t// Compensation for browsers that dont support \"width\" and \"height\".\n\t\t\t\t\t\tvar rectWidth = rect.width || rect.right - rect.left,\n\t\t\t\t\t\t\trectHeight = rect.height || rect.bottom - rect.top;\n\n\t\t\t\t\t\t// Check if default horizontal layout is impossible.\n\t\t\t\t\t\tvar spaceAfter = rtl ? rect.right : viewportSize.width - rect.left,\n\t\t\t\t\t\t\tspaceBefore = rtl ? viewportSize.width - rect.right : rect.left;\n\n\t\t\t\t\t\tif ( rtl ) {\n\t\t\t\t\t\t\tif ( spaceAfter < rectWidth ) {\n\t\t\t\t\t\t\t\t// Flip to show on right.\n\t\t\t\t\t\t\t\tif ( spaceBefore > rectWidth )\n\t\t\t\t\t\t\t\t\tleft += rectWidth;\n\t\t\t\t\t\t\t\t// Align to window left.\n\t\t\t\t\t\t\t\telse if ( viewportSize.width > rectWidth )\n\t\t\t\t\t\t\t\t\tleft = left - rect.left;\n\t\t\t\t\t\t\t\t// Align to window right, never cutting the panel at right.\n\t\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\t\tleft = left - rect.right + viewportSize.width;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else if ( spaceAfter < rectWidth ) {\n\t\t\t\t\t\t\t// Flip to show on left.\n\t\t\t\t\t\t\tif ( spaceBefore > rectWidth )\n\t\t\t\t\t\t\t\tleft -= rectWidth;\n\t\t\t\t\t\t\t// Align to window right.\n\t\t\t\t\t\t\telse if ( viewportSize.width > rectWidth )\n\t\t\t\t\t\t\t\tleft = left - rect.right + viewportSize.width;\n\t\t\t\t\t\t\t// Align to window left, never cutting the panel at left.\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\tleft = left - rect.left;\n\t\t\t\t\t\t}\n\n\n\t\t\t\t\t\t// Check if the default vertical layout is possible.\n\t\t\t\t\t\tvar spaceBelow = viewportSize.height - rect.top,\n\t\t\t\t\t\t\tspaceAbove = rect.top;\n\n\t\t\t\t\t\tif ( spaceBelow < rectHeight ) {\n\t\t\t\t\t\t\t// Flip to show above.\n\t\t\t\t\t\t\tif ( spaceAbove > rectHeight )\n\t\t\t\t\t\t\t\ttop -= rectHeight;\n\t\t\t\t\t\t\t// Align to window bottom.\n\t\t\t\t\t\t\telse if ( viewportSize.height > rectHeight )\n\t\t\t\t\t\t\t\ttop = top - rect.bottom + viewportSize.height;\n\t\t\t\t\t\t\t// Align to top, never cutting the panel at top.\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\ttop = top - rect.top;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// If IE is in RTL, we have troubles with absolute\n\t\t\t\t\t\t// position and horizontal scrolls. Here we have a\n\t\t\t\t\t\t// series of hacks to workaround it. (http://dev.ckeditor.com/ticket/6146)\n\t\t\t\t\t\tif ( CKEDITOR.env.ie ) {\n\t\t\t\t\t\t\tvar offsetParent = new CKEDITOR.dom.element( element.$.offsetParent ),\n\t\t\t\t\t\t\t\tscrollParent = offsetParent;\n\n\t\t\t\t\t\t\t// Quirks returns <body>, but standards returns <html>.\n\t\t\t\t\t\t\tif ( scrollParent.getName() == 'html' )\n\t\t\t\t\t\t\t\tscrollParent = scrollParent.getDocument().getBody();\n\n\t\t\t\t\t\t\tif ( scrollParent.getComputedStyle( 'direction' ) == 'rtl' ) {\n\t\t\t\t\t\t\t\t// For IE8, there is not much logic on this, but it works.\n\t\t\t\t\t\t\t\tif ( CKEDITOR.env.ie8Compat )\n\t\t\t\t\t\t\t\t\tleft -= element.getDocument().getDocumentElement().$.scrollLeft * 2;\n\t\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\t\tleft -= ( offsetParent.$.scrollWidth - offsetParent.$.clientWidth );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Trigger the onHide event of the previously active panel to prevent\n\t\t\t\t\t\t// incorrect styles from being applied (http://dev.ckeditor.com/ticket/6170)\n\t\t\t\t\t\tvar innerElement = element.getFirst(),\n\t\t\t\t\t\t\tactivePanel;\n\t\t\t\t\t\tif ( ( activePanel = innerElement.getCustomData( 'activePanel' ) ) )\n\t\t\t\t\t\t\tactivePanel.onHide && activePanel.onHide.call( this, 1 );\n\t\t\t\t\t\tinnerElement.setCustomData( 'activePanel', this );\n\n\t\t\t\t\t\telement.setStyles( {\n\t\t\t\t\t\t\ttop: top + 'px',\n\t\t\t\t\t\t\tleft: left + 'px'\n\t\t\t\t\t\t} );\n\t\t\t\t\t\telement.setOpacity( 1 );\n\n\t\t\t\t\t\tcallback && callback();\n\t\t\t\t\t}, this );\n\n\t\t\t\t\tpanel.isLoaded ? panelLoad() : panel.onLoad = panelLoad;\n\n\t\t\t\t\tCKEDITOR.tools.setTimeout( function() {\n\t\t\t\t\t\tvar scrollTop = CKEDITOR.env.webkit && CKEDITOR.document.getWindow().getScrollPosition().y;\n\n\t\t\t\t\t\t// Focus the panel frame first, so blur gets fired.\n\t\t\t\t\t\tthis.focus();\n\n\t\t\t\t\t\t// Focus the block now.\n\t\t\t\t\t\tblock.element.focus();\n\n\t\t\t\t\t\t// http://dev.ckeditor.com/ticket/10623, http://dev.ckeditor.com/ticket/10951 - restore the viewport's scroll position after focusing list element.\n\t\t\t\t\t\tif ( CKEDITOR.env.webkit )\n\t\t\t\t\t\t\tCKEDITOR.document.getBody().$.scrollTop = scrollTop;\n\n\t\t\t\t\t\t// We need this get fired manually because of unfired focus() function.\n\t\t\t\t\t\tthis.allowBlur( true );\n\n\t\t\t\t\t\t// Ensure that the first item is focused (http://dev.ckeditor.com/ticket/16804).\n\t\t\t\t\t\tif ( CKEDITOR.env.ie ) {\n\t\t\t\t\t\t\tCKEDITOR.tools.setTimeout( function() {\n\t\t\t\t\t\t\t\tblock.markFirstDisplayed ? block.markFirstDisplayed() : block._.markFirstDisplayed();\n\t\t\t\t\t\t\t}, 0 );\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tblock.markFirstDisplayed ? block.markFirstDisplayed() : block._.markFirstDisplayed();\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis._.editor.fire( 'panelShow', this );\n\t\t\t\t\t}, 0, this );\n\t\t\t\t}, CKEDITOR.env.air ? 200 : 0, this );\n\t\t\t\tthis.visible = 1;\n\n\t\t\t\tif ( this.onShow )\n\t\t\t\t\tthis.onShow.call( this );\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * Repositions the panel with the same parameters that were used in the last {@link #showBlock} call.\n\t\t\t *\n\t\t\t * @since 4.5.4\n\t\t\t */\n\t\t\treposition: function() {\n\t\t\t\tvar blockParams = this._.showBlockParams;\n\n\t\t\t\tif ( this.visible && this._.showBlockParams ) {\n\t\t\t\t\tthis.hide();\n\t\t\t\t\tthis.showBlock.apply( this, blockParams );\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * Restores the last focused element or simply focuses the panel window.\n\t\t\t */\n\t\t\tfocus: function() {\n\t\t\t\t// Webkit requires to blur any previous focused page element, in\n\t\t\t\t// order to properly fire the \"focus\" event.\n\t\t\t\tif ( CKEDITOR.env.webkit ) {\n\t\t\t\t\tvar active = CKEDITOR.document.getActive();\n\t\t\t\t\tactive && !active.equals( this._.iframe ) && active.$.blur();\n\t\t\t\t}\n\n\t\t\t\t// Restore last focused element or simply focus panel window.\n\t\t\t\tvar focus = this._.lastFocused || this._.iframe.getFrameDocument().getWindow();\n\t\t\t\tfocus.focus();\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * @todo\n\t\t\t */\n\t\t\tblur: function() {\n\t\t\t\tvar doc = this._.iframe.getFrameDocument(),\n\t\t\t\t\tactive = doc.getActive();\n\n\t\t\t\tactive && active.is( 'a' ) && ( this._.lastFocused = active );\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * Hides the panel.\n\t\t\t *\n\t\t\t * @todo\n\t\t\t */\n\t\t\thide: function( returnFocus ) {\n\t\t\t\tif ( this.visible && ( !this.onHide || this.onHide.call( this ) !== true ) ) {\n\t\t\t\t\tthis.hideChild();\n\t\t\t\t\t// Blur previously focused element. (http://dev.ckeditor.com/ticket/6671)\n\t\t\t\t\tCKEDITOR.env.gecko && this._.iframe.getFrameDocument().$.activeElement.blur();\n\t\t\t\t\tthis.element.setStyle( 'display', 'none' );\n\t\t\t\t\tthis.visible = 0;\n\t\t\t\t\tthis.element.getFirst().removeCustomData( 'activePanel' );\n\n\t\t\t\t\t// Return focus properly. (http://dev.ckeditor.com/ticket/6247)\n\t\t\t\t\tvar focusReturn = returnFocus && this._.returnFocus;\n\t\t\t\t\tif ( focusReturn ) {\n\t\t\t\t\t\t// Webkit requires focus moved out panel iframe first.\n\t\t\t\t\t\tif ( CKEDITOR.env.webkit && focusReturn.type )\n\t\t\t\t\t\t\tfocusReturn.getWindow().$.focus();\n\n\t\t\t\t\t\tfocusReturn.focus();\n\t\t\t\t\t}\n\n\t\t\t\t\tdelete this._.lastFocused;\n\t\t\t\t\tthis._.showBlockParams = null;\n\n\t\t\t\t\tthis._.editor.fire( 'panelHide', this );\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * @todo\n\t\t\t */\n\t\t\tallowBlur: function( allow ) {\n\t\t\t\t// Prevent editor from hiding the panel. (http://dev.ckeditor.com/ticket/3222)\n\t\t\t\tvar panel = this._.panel;\n\t\t\t\tif ( allow !== undefined )\n\t\t\t\t\tpanel.allowBlur = allow;\n\n\t\t\t\treturn panel.allowBlur;\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * Shows the specified panel as a child of one block of this one.\n\t\t\t *\n\t\t\t * @param {CKEDITOR.ui.floatPanel} panel\n\t\t\t * @param {String} blockName\n\t\t\t * @param {CKEDITOR.dom.element} offsetParent Positioned parent.\n\t\t\t * @param {Number} corner\n\t\t\t *\n\t\t\t * * For LTR (left to right) oriented editor:\n\t\t\t *      * `1` = top-left\n\t\t\t *      * `2` = top-right\n\t\t\t *      * `3` = bottom-right\n\t\t\t *      * `4` = bottom-left\n\t\t\t * * For RTL (right to left):\n\t\t\t *      * `1` = top-right\n\t\t\t *      * `2` = top-left\n\t\t\t *      * `3` = bottom-left\n\t\t\t *      * `4` = bottom-right\n\t\t\t *\n\t\t\t * @param {Number} [offsetX=0]\n\t\t\t * @param {Number} [offsetY=0]\n\t\t\t * @todo\n\t\t\t */\n\t\t\tshowAsChild: function( panel, blockName, offsetParent, corner, offsetX, offsetY ) {\n\t\t\t\t// Skip reshowing of child which is already visible.\n\t\t\t\tif ( this._.activeChild == panel && panel._.panel._.offsetParentId == offsetParent.getId() )\n\t\t\t\t\treturn;\n\n\t\t\t\tthis.hideChild();\n\n\t\t\t\tpanel.onHide = CKEDITOR.tools.bind( function() {\n\t\t\t\t\t// Use a timeout, so we give time for this menu to get\n\t\t\t\t\t// potentially focused.\n\t\t\t\t\tCKEDITOR.tools.setTimeout( function() {\n\t\t\t\t\t\tif ( !this._.focused )\n\t\t\t\t\t\t\tthis.hide();\n\t\t\t\t\t}, 0, this );\n\t\t\t\t}, this );\n\n\t\t\t\tthis._.activeChild = panel;\n\t\t\t\tthis._.focused = false;\n\n\t\t\t\tpanel.showBlock( blockName, offsetParent, corner, offsetX, offsetY );\n\t\t\t\tthis.blur();\n\n\t\t\t\t/* http://dev.ckeditor.com/ticket/3767 IE: Second level menu may not have borders */\n\t\t\t\tif ( CKEDITOR.env.ie7Compat || CKEDITOR.env.ie6Compat ) {\n\t\t\t\t\tsetTimeout( function() {\n\t\t\t\t\t\tpanel.element.getChild( 0 ).$.style.cssText += '';\n\t\t\t\t\t}, 100 );\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * @todo\n\t\t\t */\n\t\t\thideChild: function( restoreFocus ) {\n\t\t\t\tvar activeChild = this._.activeChild;\n\n\t\t\t\tif ( activeChild ) {\n\t\t\t\t\tdelete activeChild.onHide;\n\t\t\t\t\tdelete this._.activeChild;\n\t\t\t\t\tactiveChild.hide();\n\n\t\t\t\t\t// At this point focus should be moved back to parent panel.\n\t\t\t\t\trestoreFocus && this.focus();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t} );\n\n\tCKEDITOR.on( 'instanceDestroyed', function() {\n\t\tvar isLastInstance = CKEDITOR.tools.isEmpty( CKEDITOR.instances );\n\n\t\tfor ( var i in panels ) {\n\t\t\tvar panel = panels[ i ];\n\t\t\t// Safe to destroy it since there're no more instances.(http://dev.ckeditor.com/ticket/4241)\n\t\t\tif ( isLastInstance )\n\t\t\t\tpanel.destroy();\n\t\t\t// Panel might be used by other instances, just hide them.(http://dev.ckeditor.com/ticket/4552)\n\t\t\telse\n\t\t\t\tpanel.element.hide();\n\t\t}\n\t\t// Remove the registration.\n\t\tisLastInstance && ( panels = {} );\n\n\t} );\n} )();\n"]}